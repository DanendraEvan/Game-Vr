<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Nametag Example — Networked-Aframe</title>
    <meta name="description" content="Nametag — Networked-Aframe" />

    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <!-- TODO with aframe 1.5.0 I get
      three.module.js:48346 THREE.PropertyBinding: No target node found for track: master.quaternion.
      three.module.js:48346 THREE.PropertyBinding: No target node found for track: Reference.quaternion. -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.5.0/socket.io.slim.js"></script>
    <script src="/easyrtc/easyrtc.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/networked-aframe@0.11.1/dist/networked-aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/networked-aframe@0.11.1/examples/js/spawn-in-circle.component.js"></script>
    <script src="/dist/components.js"></script>
    <script defer src="/dist/ui.js"></script>
  </head>

  <body>
    <a-scene
      networked-scene="
        connectOnLoad: false;
        room: nametag;
        debug: true;
        adapter: wseasyrtc;
    "
      renderer="physicallyCorrectLights:true;colorManagement:true"
      shadow="type: pcfsoft"
      gltf-model="meshoptDecoderPath:https://unpkg.com/meshoptimizer@0.19.0/meshopt_decoder.js"
    >
      <a-assets>
        <template id="avatar-template">
          <a-entity player-info>
            <a-entity class="model"></a-entity>
            <!-- <a-entity class="camera" networked-audio-source></a-entity> -->
            <a-entity class="camera"></a-entity>
          </a-entity>
        </template>
      </a-assets>

      <a-entity environment="preset:forest;shadow:true"></a-entity>
      <a-entity light="type:ambient;intensity:0.5"></a-entity>

      <a-entity
        id="rig"
        movement-controls="fly:false"
        spawn-in-circle="radius:3"
        networked="template:#avatar-template;attachTemplateToLocal:false"
        player-info
      >
        <a-entity id="player" class="camera" camera position="0 1.6 0" look-controls></a-entity>
      </a-entity>
    </a-scene>
  </body>
</html>
